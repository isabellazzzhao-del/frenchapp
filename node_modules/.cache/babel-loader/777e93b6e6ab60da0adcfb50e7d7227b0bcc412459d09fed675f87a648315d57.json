{"ast":null,"code":"var _jsxFileName = \"/Users/zhaolu/Documents/Code/frenchapp/src/App.js\",\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Search, Volume2, Star, BookOpen, ArrowRight, Loader2, Layers, X, ChevronDown, ChevronUp, Info, Mic, MessageCircle, Send, Heart, PlayCircle } from 'lucide-react';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';\nimport { getFirestore, collection, addDoc, query, onSnapshot, deleteDoc, doc, serverTimestamp, where, getDocs } from 'firebase/firestore';\n\n// ==========================================\n// ⚠️ 请在下方填入您的配置信息\n// ==========================================\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCBItd52zWdktiEuHmQIXbB4Q7sLM5602o\",\n  authDomain: \"frenchapp-6b44a.firebaseapp.com\",\n  projectId: \"frenchapp-6b44a\",\n  storageBucket: \"frenchapp-6b44a.firebasestorage.app\",\n  messagingSenderId: \"988616724582\",\n  appId: \"1:988616724582:web:723f9d9c75f8810b019da7\"\n};\nconst GEMINI_API_KEY = \"AIzaSyBivevjn0wQ3dD2OCuh98L2iALBssZfsq4\";\n\n// ==========================================\n\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\nconst appId = \"french-memo-app\";\n\n// --- API Helper for Gemini ---\n\n// 1. 获取单个单词详情 (支持多语言输入)\nconst fetchWordData = async input => {\n  var _data$candidates, _data$candidates$, _data$candidates$$con, _data$candidates$$con2, _data$candidates$$con3;\n  const apiKey = GEMINI_API_KEY;\n  if (!apiKey || apiKey.includes(\"YOUR_GEMINI_API_KEY\")) throw new Error(\"API Key not set\");\n\n  // 优化：Prompt 强调极致简洁，仅返回对应翻译，减少 Token 生成量以提升速度\n  const prompt = `\n    User input: \"${input}\".\n    Task: \n    1. Detect language. If NOT French, translate to common French word.\n    2. Analyze the French word.\n    \n    CRITICAL: Keep definitions EXTREMELY SHORT (1-3 words max). Just the direct translation. NO explanations.\n    \n    Return strictly valid JSON (no markdown):\n    {\n      \"word\": \"The French word\",\n      \"definitions\": {\n        \"en\": \"Direct translation (1-3 words)\",\n        \"zh\": \"直接的中文对应词(仅词义，不解释)\"\n      },\n      \"partOfSpeech\": \"abbrev. (n.m./adj.)\",\n      \"collection\": \"Category (e.g. Fruits)\",\n      \"relatedWords\": [\"synonym1\", \"antonym1\", \"related1\"],\n      \"relatedPhrases\": [\n        {\"fr\": \"Phrase 1\", \"zh\": \"Meaning 1\"},\n        {\"fr\": \"Phrase 2\", \"zh\": \"Meaning 2\"}\n      ],\n      \"examplePhrase\": {\n        \"fr\": \"Simple French sentence\",\n        \"en\": \"English translation\",\n        \"zh\": \"Chinese translation\",\n        \"explanation\": \"Brief grammar note\"\n      }\n    }\n  `;\n  const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      contents: [{\n        parts: [{\n          text: prompt\n        }]\n      }]\n    })\n  });\n  const data = await response.json();\n  const text = (_data$candidates = data.candidates) === null || _data$candidates === void 0 ? void 0 : (_data$candidates$ = _data$candidates[0]) === null || _data$candidates$ === void 0 ? void 0 : (_data$candidates$$con = _data$candidates$.content) === null || _data$candidates$$con === void 0 ? void 0 : (_data$candidates$$con2 = _data$candidates$$con.parts) === null || _data$candidates$$con2 === void 0 ? void 0 : (_data$candidates$$con3 = _data$candidates$$con2[0]) === null || _data$candidates$$con3 === void 0 ? void 0 : _data$candidates$$con3.text;\n  return text ? JSON.parse(text) : null;\n};\n\n// 2. 获取专辑列表详情 (Prompt优化以提升速度)\nconst fetchAlbumData = async category => {\n  var _data$candidates2, _data$candidates2$, _data$candidates2$$co, _data$candidates2$$co2, _data$candidates2$$co3;\n  const apiKey = GEMINI_API_KEY;\n  const prompt = `\n    List 8 common French vocabulary items for category: \"${category}\".\n    Return valid JSON:\n    {\n      \"category\": \"${category}\",\n      \"items\": [\n        { \"word\": \"FrenchWord\", \"article\": \"le/la/un\", \"zh\": \"Chinese\", \"isVisual\": true/false }\n      ]\n    }\n  `;\n  const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      contents: [{\n        parts: [{\n          text: prompt\n        }]\n      }]\n    })\n  });\n  const data = await response.json();\n  const text = (_data$candidates2 = data.candidates) === null || _data$candidates2 === void 0 ? void 0 : (_data$candidates2$ = _data$candidates2[0]) === null || _data$candidates2$ === void 0 ? void 0 : (_data$candidates2$$co = _data$candidates2$.content) === null || _data$candidates2$$co === void 0 ? void 0 : (_data$candidates2$$co2 = _data$candidates2$$co.parts) === null || _data$candidates2$$co2 === void 0 ? void 0 : (_data$candidates2$$co3 = _data$candidates2$$co2[0]) === null || _data$candidates2$$co3 === void 0 ? void 0 : _data$candidates2$$co3.text;\n  return text ? JSON.parse(text) : null;\n};\n\n// 3. 聊天 API\nconst fetchChatResponse = async (history, message) => {\n  var _data$candidates3, _data$candidates3$, _data$candidates3$$co, _data$candidates3$$co2, _data$candidates3$$co3;\n  const apiKey = GEMINI_API_KEY;\n  const prompt = `\n    You are a friendly French language tutor. \n    User message: \"${message}\".\n    Conversation history: ${JSON.stringify(history)}.\n    Reply in French, followed by a very brief English translation in parentheses. Keep it conversational and helpful.\n  `;\n  const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      contents: [{\n        parts: [{\n          text: prompt\n        }]\n      }]\n    })\n  });\n  const data = await response.json();\n  return ((_data$candidates3 = data.candidates) === null || _data$candidates3 === void 0 ? void 0 : (_data$candidates3$ = _data$candidates3[0]) === null || _data$candidates3$ === void 0 ? void 0 : (_data$candidates3$$co = _data$candidates3$.content) === null || _data$candidates3$$co === void 0 ? void 0 : (_data$candidates3$$co2 = _data$candidates3$$co.parts) === null || _data$candidates3$$co2 === void 0 ? void 0 : (_data$candidates3$$co3 = _data$candidates3$$co2[0]) === null || _data$candidates3$$co3 === void 0 ? void 0 : _data$candidates3$$co3.text) || \"Désolé, je ne comprends pas.\";\n};\nexport default function App() {\n  _s2();\n  var _s = $RefreshSig$();\n  const [user, setUser] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [currentWordData, setCurrentWordData] = useState(null);\n\n  // 缓存机制优化：存储已查询过的单词和专辑，避免重复请求\n  const [wordCache, setWordCache] = useState({});\n  const [albumData, setAlbumData] = useState(null);\n  const [albumCache, setAlbumCache] = useState({});\n\n  // 收藏相关\n  const [favorites, setFavorites] = useState([]);\n  const [favoriteAlbums, setFavoriteAlbums] = useState([]);\n\n  // 聊天相关\n  const [messages, setMessages] = useState([{\n    role: 'ai',\n    text: 'Bonjour! Je suis ton prof de français. On discute? (你好！我是你的法语老师，我们聊聊？)'\n  }]);\n  const [chatInput, setChatInput] = useState('');\n  const [isRecording, setIsRecording] = useState(false);\n  const chatEndRef = useRef(null);\n  const [activeTab, setActiveTab] = useState('search'); // 'search', 'favorites', 'album', 'chat'\n\n  const getImageUrl = (keyword, size = 'medium') => {\n    const dimensions = size === 'small' ? 'width=200&height=200' : 'width=600&height=400';\n    // 增加随机数防止缓存导致图片不变\n    return `https://image.pollinations.ai/prompt/realistic%20${keyword}%20french%20context?${dimensions}&nologo=true&seed=${Math.random()}`;\n  };\n  useEffect(() => {\n    signInAnonymously(auth).catch(console.error);\n    const unsubscribe = onAuthStateChanged(auth, setUser);\n    return () => unsubscribe();\n  }, []);\n\n  // 同步单词收藏\n  useEffect(() => {\n    if (!user) return;\n    const q = query(collection(db, 'artifacts', appId, 'users', user.uid, 'favorites'));\n    const unsubscribe = onSnapshot(q, snapshot => {\n      const favs = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      favs.sort((a, b) => {\n        var _b$timestamp, _a$timestamp;\n        return (((_b$timestamp = b.timestamp) === null || _b$timestamp === void 0 ? void 0 : _b$timestamp.seconds) || 0) - (((_a$timestamp = a.timestamp) === null || _a$timestamp === void 0 ? void 0 : _a$timestamp.seconds) || 0);\n      });\n      setFavorites(favs);\n    });\n    return () => unsubscribe();\n  }, [user]);\n\n  // 同步专辑收藏\n  useEffect(() => {\n    if (!user) return;\n    const q = query(collection(db, 'artifacts', appId, 'users', user.uid, 'favoriteAlbums'));\n    const unsubscribe = onSnapshot(q, snapshot => {\n      const favs = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      setFavoriteAlbums(favs);\n    });\n    return () => unsubscribe();\n  }, [user]);\n\n  // 聊天滚动到底部\n  useEffect(() => {\n    var _chatEndRef$current;\n    (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages, activeTab]);\n\n  // --- Handlers ---\n  const handleSearch = async (e, wordOverride = null) => {\n    if (e) e.preventDefault();\n    const term = wordOverride || searchTerm;\n    const cleanTerm = term.trim().toLowerCase(); // 统一小写作为 key\n    if (!cleanTerm) return;\n    setLoading(true);\n    setCurrentWordData(null);\n    setAlbumData(null);\n    setActiveTab('search');\n\n    // 1. 检查缓存\n    if (wordCache[cleanTerm]) {\n      setCurrentWordData(wordCache[cleanTerm]);\n      setLoading(false);\n      return;\n    }\n    try {\n      const data = await fetchWordData(term);\n      setCurrentWordData(data);\n      // 2. 写入缓存\n      setWordCache(prev => ({\n        ...prev,\n        [cleanTerm]: data,\n        [data.word.toLowerCase()]: data\n      }));\n    } catch (err) {\n      alert(\"Error fetching word. Try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleSpeak = text => {\n    if ('speechSynthesis' in window) {\n      window.speechSynthesis.cancel();\n      const utterance = new SpeechSynthesisUtterance(text);\n      utterance.lang = 'fr-FR';\n      utterance.rate = 0.9;\n      window.speechSynthesis.speak(utterance);\n    }\n  };\n  const handleAlbumClick = async category => {\n    setActiveTab('album');\n\n    // 检查缓存\n    if (albumCache[category]) {\n      setAlbumData(albumCache[category]);\n      return;\n    }\n    setLoading(true);\n    setAlbumData(null);\n    try {\n      const data = await fetchAlbumData(category);\n      setAlbumData(data);\n      // 写入缓存\n      setAlbumCache(prev => ({\n        ...prev,\n        [category]: data\n      }));\n    } catch (err) {\n      console.error(err);\n      alert(\"Failed to load album.\");\n      setActiveTab('search');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // --- Favorites Logic ---\n  const toggleFavoriteWord = async wordData => {\n    if (!user) return;\n    // 检查是否已收藏\n    const existing = favorites.find(f => f.word === wordData.word);\n    try {\n      if (existing) {\n        await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'favorites', existing.id));\n      } else {\n        await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'favorites'), {\n          ...wordData,\n          timestamp: serverTimestamp()\n        });\n      }\n    } catch (e) {\n      console.error(\"Fav Error\", e);\n      alert(\"操作失败，请检查网络\");\n    }\n  };\n  const toggleFavoriteAlbum = async albumData => {\n    if (!user || !albumData) return;\n    const existing = favoriteAlbums.find(f => f.category === albumData.category);\n    try {\n      if (existing) {\n        await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'favoriteAlbums', existing.id));\n      } else {\n        await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'favoriteAlbums'), {\n          ...albumData,\n          timestamp: serverTimestamp()\n        });\n      }\n    } catch (e) {\n      console.error(\"Album Fav Error\", e);\n    }\n  };\n\n  // --- Chat Logic ---\n  const handleSendChat = async () => {\n    if (!chatInput.trim()) return;\n    const userMsg = {\n      role: 'user',\n      text: chatInput\n    };\n    setMessages(prev => [...prev, userMsg]);\n    setChatInput('');\n\n    // 简单的加载状态模拟\n    setMessages(prev => [...prev, {\n      role: 'ai',\n      text: '...',\n      isLoading: true\n    }]);\n    try {\n      const responseText = await fetchChatResponse(messages.map(m => ({\n        role: m.role,\n        content: m.text\n      })), userMsg.text);\n      setMessages(prev => {\n        const newMsgs = prev.filter(m => !m.isLoading);\n        return [...newMsgs, {\n          role: 'ai',\n          text: responseText\n        }];\n      });\n      handleSpeak(responseText); // 自动朗读回复\n    } catch (e) {\n      setMessages(prev => prev.filter(m => !m.isLoading));\n    }\n  };\n  const startListening = () => {\n    if (!('webkitSpeechRecognition' in window)) {\n      alert(\"此浏览器不支持语音输入，请使用 Chrome。\");\n      return;\n    }\n    const recognition = new window.webkitSpeechRecognition();\n    recognition.lang = 'fr-FR'; // 默认听法语，也可以设为 'zh-CN'\n    recognition.continuous = false;\n    recognition.interimResults = false;\n    recognition.onstart = () => setIsRecording(true);\n    recognition.onend = () => setIsRecording(false);\n    recognition.onresult = event => {\n      const transcript = event.results[0][0].transcript;\n      setChatInput(transcript);\n    };\n    recognition.start();\n  };\n\n  // --- Components ---\n\n  const AlbumView = ({\n    data\n  }) => {\n    if (!data) return null;\n    const isFav = favoriteAlbums.some(f => f.category === data.category);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveTab('search'),\n            className: \"p-2 hover:bg-gray-100 rounded-full transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(ArrowRight, {\n              className: \"rotate-180 text-gray-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-2xl font-bold text-gray-900 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(Layers, {\n              className: \"text-blue-600\",\n              size: 24\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 15\n            }, this), data.category]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => toggleFavoriteAlbum(data),\n          className: `p-3 rounded-full transition-colors ${isFav ? 'bg-red-50 text-red-500' : 'bg-gray-50 text-gray-400 hover:text-red-400'}`,\n          children: /*#__PURE__*/_jsxDEV(Heart, {\n            size: 24,\n            fill: isFav ? \"currentColor\" : \"none\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4\",\n        children: data.items.map((item, idx) => {\n          if (item.isVisual) {\n            return /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleSearch(null, item.word),\n              className: \"group relative flex flex-col items-center bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-lg transition-all border border-gray-100 text-left\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-full aspect-[4/3] bg-gray-50 relative overflow-hidden\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: getImageUrl(item.word, 'small'),\n                  alt: item.word,\n                  className: \"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 362,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-3 pt-8\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-white font-medium text-lg\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"opacity-70 text-sm mr-1 font-normal\",\n                      children: item.article\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 369,\n                      columnNumber: 26\n                    }, this), item.word]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 368,\n                    columnNumber: 24\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 19\n              }, this)\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 17\n            }, this);\n          } else {\n            return /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleSearch(null, item.word),\n              className: \"col-span-2 flex items-center justify-between p-4 bg-white rounded-xl shadow-sm hover:shadow-md border border-gray-100 hover:border-blue-200 transition-all group\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-lg font-bold text-gray-800 group-hover:text-blue-600 transition-colors\",\n                  children: item.word\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 384,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-500 font-medium\",\n                children: item.zh\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 19\n              }, this)]\n            }, idx, true, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 17\n            }, this);\n          }\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 7\n    }, this);\n  };\n  const WordCard = ({\n    data,\n    onDelete\n  }) => {\n    _s();\n    const [showPhraseDetails, setShowPhraseDetails] = useState(false);\n    const [showAllPhrases, setShowAllPhrases] = useState(false);\n    const isFav = favorites.some(f => f.word === data.word);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-[2rem] shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"h-56 overflow-hidden bg-gray-50 relative\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: getImageUrl(data.word),\n          alt: data.word,\n          className: \"w-full h-full object-cover\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-2 px-8 pt-4 bg-white\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"bg-blue-50 px-3 py-1.5 rounded-full text-xs font-bold text-blue-600 uppercase tracking-wider\",\n          children: data.partOfSpeech\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleAlbumClick(data.collection),\n          className: \"bg-gray-100 hover:bg-gray-200 px-3 py-1.5 rounded-full text-xs font-bold text-gray-600 flex items-center gap-1.5 transition-colors cursor-pointer\",\n          children: [/*#__PURE__*/_jsxDEV(Layers, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 11\n          }, this), data.collection]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-8 pt-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-4xl font-bold text-gray-900 tracking-tight\",\n              children: data.word\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => {\n                e.stopPropagation();\n                handleSpeak(data.word);\n              },\n              className: \"p-2.5 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors\",\n              children: /*#__PURE__*/_jsxDEV(Volume2, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 11\n          }, this), onDelete ? /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => onDelete(data.id),\n            className: \"p-2.5 rounded-full text-gray-300 hover:text-red-500 hover:bg-red-50 transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              size: 22\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 16\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 14\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toggleFavoriteWord(data),\n            className: `p-2.5 rounded-full transition-colors ${isFav ? 'text-yellow-400 bg-yellow-50' : 'text-gray-300 hover:text-yellow-400 hover:bg-yellow-50'}`,\n            children: /*#__PURE__*/_jsxDEV(Star, {\n              size: 22,\n              fill: isFav ? \"currentColor\" : \"none\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 434,\n              columnNumber: 16\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 14\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-8 space-y-3 bg-gray-50/50 p-4 rounded-xl\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col gap-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs font-bold text-gray-400 uppercase\",\n              children: \"CN\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 442,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xl font-bold text-gray-900 leading-snug\",\n              children: data.definitions.zh\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 14\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-px bg-gray-200 w-full my-1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col gap-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs font-bold text-gray-400 uppercase\",\n              children: \"EN\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 14\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-lg font-medium text-gray-600 leading-snug\",\n              children: data.definitions.en\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 14\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 12\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: () => {\n              handleSpeak(data.examplePhrase.fr);\n              setShowPhraseDetails(!showPhraseDetails);\n            },\n            className: \"bg-blue-50/50 rounded-xl border border-blue-100 overflow-hidden cursor-pointer hover:bg-blue-50 transition-colors\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-4 flex justify-between items-start gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center gap-2 mb-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-[10px] font-bold text-blue-400 uppercase tracking-widest\",\n                    children: \"Exemple\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 458,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Mic, {\n                    size: 12,\n                    className: \"text-blue-400\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 459,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 457,\n                  columnNumber: 18\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xl text-gray-800 font-serif italic leading-snug\",\n                  children: [\"\\\"\", data.examplePhrase.fr, \"\\\"\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 461,\n                  columnNumber: 18\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 16\n              }, this), /*#__PURE__*/_jsxDEV(ChevronDown, {\n                size: 18,\n                className: `text-blue-300 mt-2 transition-transform ${showPhraseDetails ? 'rotate-180' : ''}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 16\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 455,\n              columnNumber: 13\n            }, this), showPhraseDetails && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"px-4 pb-4 pt-0 space-y-2 animate-in slide-in-from-top-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-600\",\n                children: data.examplePhrase.zh\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 467,\n                columnNumber: 18\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-500\",\n                children: data.examplePhrase.en\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 468,\n                columnNumber: 18\n              }, this), data.examplePhrase.explanation && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 text-xs text-blue-500 bg-blue-100/50 p-2 rounded-lg\",\n                children: [\"\\uD83D\\uDCA1 \", data.examplePhrase.explanation]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 20\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 11\n          }, this), data.relatedPhrases && data.relatedPhrases.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pl-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider\",\n              children: \"\\u5E38\\u7528\\u77ED\\u8BED\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2\",\n              children: data.relatedPhrases.slice(0, showAllPhrases ? undefined : 2).map((phrase, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-center group py-1 border-b border-gray-50 last:border-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-700 font-medium cursor-pointer hover:text-blue-600\",\n                  onClick: () => handleSpeak(phrase.fr),\n                  children: phrase.fr\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 483,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-sm text-gray-400\",\n                  children: phrase.zh\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 484,\n                  columnNumber: 23\n                }, this)]\n              }, idx, true, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 20\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this), data.relatedPhrases.length > 2 && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowAllPhrases(!showAllPhrases),\n              className: \"text-xs text-blue-500 font-medium mt-2 hover:underline flex items-center gap-1\",\n              children: showAllPhrases ? \"收起\" : `查看更多 (${data.relatedPhrases.length - 2})`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 9\n        }, this), data.relatedWords && data.relatedWords.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pt-8 mt-8 border-t border-gray-100\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex overflow-x-auto pb-4 gap-3 no-scrollbar\",\n            children: data.relatedWords.map((word, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleSearch(null, word),\n              className: \"flex-shrink-0 flex flex-col items-center w-20 group\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-16 h-16 rounded-xl overflow-hidden mb-2 bg-gray-100 border border-gray-200 group-hover:border-blue-300 transition-all\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: getImageUrl(word, 'small'),\n                  className: \"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-110 transition-all\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 504,\n                  columnNumber: 24\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs text-gray-500 group-hover:text-blue-600 truncate w-full text-center\",\n                children: word\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 506,\n                columnNumber: 21\n              }, this)]\n            }, idx, true, {\n              fileName: _jsxFileName,\n              lineNumber: 502,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 500,\n            columnNumber: 14\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 5\n    }, this);\n  };\n  _s(WordCard, \"j5lNyFO2DNPlarnGtRR+cOgFvFA=\");\n  const ChatView = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-[calc(100vh-140px)]\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto p-4 space-y-4\",\n      children: [messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `max-w-[80%] p-4 rounded-2xl ${msg.role === 'user' ? 'bg-blue-600 text-white rounded-br-none' : 'bg-white border border-gray-100 text-gray-800 rounded-bl-none shadow-sm'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm leading-relaxed\",\n            children: msg.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 527,\n            columnNumber: 15\n          }, this), msg.role === 'ai' && !msg.isLoading && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleSpeak(msg.text),\n            className: \"mt-2 text-blue-400 hover:text-blue-600\",\n            children: /*#__PURE__*/_jsxDEV(Volume2, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 115\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 529,\n            columnNumber: 18\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 13\n        }, this)\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: chatEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 519,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 bg-white border-t border-gray-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 bg-gray-50 p-2 rounded-full border border-gray-200 focus-within:ring-2 focus-within:ring-blue-100 transition-all\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: chatInput,\n          onChange: e => setChatInput(e.target.value),\n          placeholder: \"Type or speak (French)...\",\n          className: \"flex-1 bg-transparent border-none focus:ring-0 px-4 py-2 text-gray-800 placeholder-gray-400\",\n          onKeyDown: e => e.key === 'Enter' && handleSendChat()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 538,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startListening,\n          className: `p-2 rounded-full transition-colors ${isRecording ? 'bg-red-500 text-white animate-pulse' : 'text-gray-400 hover:text-blue-600'}`,\n          children: /*#__PURE__*/_jsxDEV(Mic, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 550,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSendChat,\n          className: \"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors shadow-md disabled:opacity-50\",\n          disabled: !chatInput.trim(),\n          children: /*#__PURE__*/_jsxDEV(Send, {\n            size: 18\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 557,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 537,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 536,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 518,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-50 font-sans text-gray-900 pb-24\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white/80 backdrop-blur-md border-b border-gray-100 sticky top-0 z-30\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-xl mx-auto px-6 py-4 flex justify-between items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          onClick: () => setActiveTab('search'),\n          className: \"text-xl font-bold text-gray-900 flex items-center gap-2 tracking-tight cursor-pointer\",\n          children: [/*#__PURE__*/_jsxDEV(BookOpen, {\n            size: 22,\n            className: \"text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 573,\n            columnNumber: 13\n          }, this), \"FrenchMemo\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-400 font-medium font-mono\",\n          children: user ? `UID: ${user.uid.slice(0, 4)}` : 'Connecting...'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 568,\n        columnNumber: 9\n      }, this), activeTab !== 'album' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex max-w-xl mx-auto px-6 overflow-x-auto no-scrollbar\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab('search'),\n          className: `flex-1 pb-3 text-sm font-semibold border-b-2 transition-all whitespace-nowrap px-4 ${activeTab === 'search' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-400 hover:text-gray-600'}`,\n          children: \"Search\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab('chat'),\n          className: `flex-1 pb-3 text-sm font-semibold border-b-2 transition-all whitespace-nowrap px-4 ${activeTab === 'chat' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-400 hover:text-gray-600'}`,\n          children: \"Chat AI\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 585,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab('favorites'),\n          className: `flex-1 pb-3 text-sm font-semibold border-b-2 transition-all whitespace-nowrap px-4 ${activeTab === 'favorites' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-400 hover:text-gray-600'}`,\n          children: [\"Favs (\", favorites.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 586,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 567,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-xl mx-auto px-6 py-8\",\n      children: [activeTab === 'chat' && /*#__PURE__*/_jsxDEV(ChatView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 594,\n        columnNumber: 34\n      }, this), activeTab === 'album' && loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-20 flex flex-col items-center\",\n        children: [/*#__PURE__*/_jsxDEV(Loader2, {\n          className: \"animate-spin text-blue-600 mb-4\",\n          size: 32\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 599,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-500\",\n          children: \"\\u6B63\\u5728\\u751F\\u6210\\u4E13\\u8F91...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 14\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 12\n      }, this), activeTab === 'album' && !loading && albumData && /*#__PURE__*/_jsxDEV(AlbumView, {\n        data: albumData\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 604,\n        columnNumber: 60\n      }, this), activeTab === 'search' && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSearch,\n          className: \"relative mb-10 group z-10\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `absolute inset-0 bg-blue-500/5 rounded-full blur-xl transition-opacity duration-300 ${loading ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 610,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: searchTerm,\n            onChange: e => setSearchTerm(e.target.value),\n            placeholder: \"\\u8F93\\u5165\\u4E2D/\\u82F1/\\u6CD5\\u6587...\",\n            className: \"w-full pl-14 pr-14 py-4 bg-white border-0 rounded-full shadow-[0_8px_30px_rgb(0,0,0,0.06)] text-xl font-medium placeholder:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500/20 transition-all relative z-10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 611,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Search, {\n            className: \"absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 z-20\",\n            size: 22\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 612,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: loading,\n            className: \"absolute right-3 top-1/2 -translate-y-1/2 p-2.5 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors disabled:opacity-70 hover:scale-105 active:scale-95 z-20 shadow-md\",\n            children: loading ? /*#__PURE__*/_jsxDEV(Loader2, {\n              className: \"animate-spin\",\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 614,\n              columnNumber: 28\n            }, this) : /*#__PURE__*/_jsxDEV(ArrowRight, {\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 614,\n              columnNumber: 77\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 613,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 609,\n          columnNumber: 13\n        }, this), currentWordData && /*#__PURE__*/_jsxDEV(WordCard, {\n          data: currentWordData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 33\n        }, this), !currentWordData && !loading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center py-16\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white p-6 rounded-full inline-block shadow-sm mb-6\",\n            children: /*#__PURE__*/_jsxDEV(Search, {\n              size: 40,\n              className: \"text-blue-100\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 620,\n              columnNumber: 88\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 620,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-gray-900 font-bold text-lg mb-2\",\n            children: \"Pr\\xEAt \\xE0 apprendre ?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 621,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-500 mb-8\",\n            children: \"\\u652F\\u6301\\u4E2D\\u6587\\u3001\\u82F1\\u8BED\\u6216\\u6CD5\\u8BED\\u8F93\\u5165\\uFF0C\\u81EA\\u52A8\\u7FFB\\u8BD1\\u5E76\\u89E3\\u6790\\u3002\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 622,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 619,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true), activeTab === 'favorites' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-8\",\n        children: [favoriteAlbums.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4\",\n            children: \"\\u6536\\u85CF\\u7684\\u4E13\\u8F91\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 633,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-3\",\n            children: favoriteAlbums.map(album => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleAlbumClick(album.category),\n              className: \"bg-white p-4 rounded-xl border border-gray-100 shadow-sm text-left hover:border-blue-200 transition-all\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-bold text-gray-800\",\n                  children: album.category\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 638,\n                  columnNumber: 26\n                }, this), /*#__PURE__*/_jsxDEV(Layers, {\n                  size: 16,\n                  className: \"text-blue-500\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 639,\n                  columnNumber: 26\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 637,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs text-gray-400 mt-2 block\",\n                children: [album.items.length, \" words\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 641,\n                columnNumber: 23\n              }, this)]\n            }, album.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 636,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 634,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 632,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4\",\n          children: \"\\u6536\\u85CF\\u7684\\u5355\\u8BCD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 648,\n          columnNumber: 13\n        }, this), favorites.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center py-10\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-500 font-medium\",\n            children: \"\\u6682\\u65E0\\u6536\\u85CF\\u5355\\u8BCD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 650,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 650,\n          columnNumber: 15\n        }, this) : favorites.map(fav => /*#__PURE__*/_jsxDEV(WordCard, {\n          data: fav,\n          onDelete: toggleFavoriteWord\n        }, fav.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 652,\n          columnNumber: 36\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 630,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 591,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 565,\n    columnNumber: 5\n  }, this);\n}\n_s2(App, \"45QvvEwqVatMzFEJSyyCLYO4J6o=\");\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Search","Volume2","Star","BookOpen","ArrowRight","Loader2","Layers","X","ChevronDown","ChevronUp","Info","Mic","MessageCircle","Send","Heart","PlayCircle","initializeApp","getAuth","signInAnonymously","onAuthStateChanged","getFirestore","collection","addDoc","query","onSnapshot","deleteDoc","doc","serverTimestamp","where","getDocs","jsxDEV","_jsxDEV","Fragment","_Fragment","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","GEMINI_API_KEY","app","auth","db","fetchWordData","input","_data$candidates","_data$candidates$","_data$candidates$$con","_data$candidates$$con2","_data$candidates$$con3","includes","Error","prompt","response","fetch","method","headers","body","JSON","stringify","contents","parts","text","data","json","candidates","content","parse","fetchAlbumData","category","_data$candidates2","_data$candidates2$","_data$candidates2$$co","_data$candidates2$$co2","_data$candidates2$$co3","fetchChatResponse","history","message","_data$candidates3","_data$candidates3$","_data$candidates3$$co","_data$candidates3$$co2","_data$candidates3$$co3","App","_s2","_s","$RefreshSig$","user","setUser","searchTerm","setSearchTerm","loading","setLoading","currentWordData","setCurrentWordData","wordCache","setWordCache","albumData","setAlbumData","albumCache","setAlbumCache","favorites","setFavorites","favoriteAlbums","setFavoriteAlbums","messages","setMessages","role","chatInput","setChatInput","isRecording","setIsRecording","chatEndRef","activeTab","setActiveTab","getImageUrl","keyword","size","dimensions","Math","random","catch","console","error","unsubscribe","q","uid","snapshot","favs","docs","map","id","sort","a","b","_b$timestamp","_a$timestamp","timestamp","seconds","_chatEndRef$current","current","scrollIntoView","behavior","handleSearch","e","wordOverride","preventDefault","term","cleanTerm","trim","toLowerCase","prev","word","err","alert","handleSpeak","window","speechSynthesis","cancel","utterance","SpeechSynthesisUtterance","lang","rate","speak","handleAlbumClick","toggleFavoriteWord","wordData","existing","find","f","toggleFavoriteAlbum","handleSendChat","userMsg","isLoading","responseText","m","newMsgs","filter","startListening","recognition","webkitSpeechRecognition","continuous","interimResults","onstart","onend","onresult","event","transcript","results","start","AlbumView","isFav","some","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","fill","items","item","idx","isVisual","src","alt","article","zh","WordCard","onDelete","showPhraseDetails","setShowPhraseDetails","showAllPhrases","setShowAllPhrases","partOfSpeech","stopPropagation","definitions","en","examplePhrase","fr","explanation","relatedPhrases","length","slice","undefined","phrase","relatedWords","ChatView","msg","ref","type","value","onChange","target","placeholder","onKeyDown","key","disabled","onSubmit","album","fav","_c","$RefreshReg$"],"sources":["/Users/zhaolu/Documents/Code/frenchapp/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { Search, Volume2, Star, BookOpen, ArrowRight, Loader2, Layers, X, ChevronDown, ChevronUp, Info, Mic, MessageCircle, Send, Heart, PlayCircle } from 'lucide-react';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';\nimport { getFirestore, collection, addDoc, query, onSnapshot, deleteDoc, doc, serverTimestamp, where, getDocs } from 'firebase/firestore';\n\n// ==========================================\n// ⚠️ 请在下方填入您的配置信息\n// ==========================================\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCBItd52zWdktiEuHmQIXbB4Q7sLM5602o\",\n  authDomain: \"frenchapp-6b44a.firebaseapp.com\",\n  projectId: \"frenchapp-6b44a\",\n  storageBucket: \"frenchapp-6b44a.firebasestorage.app\",\n  messagingSenderId: \"988616724582\",\n  appId: \"1:988616724582:web:723f9d9c75f8810b019da7\"\n};\n\n\nconst GEMINI_API_KEY = \"AIzaSyBivevjn0wQ3dD2OCuh98L2iALBssZfsq4\"; \n\n// ==========================================\n\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\nconst appId = \"french-memo-app\";\n\n// --- API Helper for Gemini ---\n\n// 1. 获取单个单词详情 (支持多语言输入)\nconst fetchWordData = async (input) => {\n  const apiKey = GEMINI_API_KEY; \n  if (!apiKey || apiKey.includes(\"YOUR_GEMINI_API_KEY\")) throw new Error(\"API Key not set\");\n\n  // 优化：Prompt 强调极致简洁，仅返回对应翻译，减少 Token 生成量以提升速度\n  const prompt = `\n    User input: \"${input}\".\n    Task: \n    1. Detect language. If NOT French, translate to common French word.\n    2. Analyze the French word.\n    \n    CRITICAL: Keep definitions EXTREMELY SHORT (1-3 words max). Just the direct translation. NO explanations.\n    \n    Return strictly valid JSON (no markdown):\n    {\n      \"word\": \"The French word\",\n      \"definitions\": {\n        \"en\": \"Direct translation (1-3 words)\",\n        \"zh\": \"直接的中文对应词(仅词义，不解释)\"\n      },\n      \"partOfSpeech\": \"abbrev. (n.m./adj.)\",\n      \"collection\": \"Category (e.g. Fruits)\",\n      \"relatedWords\": [\"synonym1\", \"antonym1\", \"related1\"],\n      \"relatedPhrases\": [\n        {\"fr\": \"Phrase 1\", \"zh\": \"Meaning 1\"},\n        {\"fr\": \"Phrase 2\", \"zh\": \"Meaning 2\"}\n      ],\n      \"examplePhrase\": {\n        \"fr\": \"Simple French sentence\",\n        \"en\": \"English translation\",\n        \"zh\": \"Chinese translation\",\n        \"explanation\": \"Brief grammar note\"\n      }\n    }\n  `;\n\n  const response = await fetch(\n    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,\n    {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }),\n    }\n  );\n  const data = await response.json();\n  const text = data.candidates?.[0]?.content?.parts?.[0]?.text;\n  return text ? JSON.parse(text) : null;\n};\n\n// 2. 获取专辑列表详情 (Prompt优化以提升速度)\nconst fetchAlbumData = async (category) => {\n  const apiKey = GEMINI_API_KEY;\n  const prompt = `\n    List 8 common French vocabulary items for category: \"${category}\".\n    Return valid JSON:\n    {\n      \"category\": \"${category}\",\n      \"items\": [\n        { \"word\": \"FrenchWord\", \"article\": \"le/la/un\", \"zh\": \"Chinese\", \"isVisual\": true/false }\n      ]\n    }\n  `;\n\n  const response = await fetch(\n    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,\n    {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }),\n    }\n  );\n  const data = await response.json();\n  const text = data.candidates?.[0]?.content?.parts?.[0]?.text;\n  return text ? JSON.parse(text) : null;\n};\n\n// 3. 聊天 API\nconst fetchChatResponse = async (history, message) => {\n  const apiKey = GEMINI_API_KEY;\n  const prompt = `\n    You are a friendly French language tutor. \n    User message: \"${message}\".\n    Conversation history: ${JSON.stringify(history)}.\n    Reply in French, followed by a very brief English translation in parentheses. Keep it conversational and helpful.\n  `;\n  \n  const response = await fetch(\n    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,\n    {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }),\n    }\n  );\n  const data = await response.json();\n  return data.candidates?.[0]?.content?.parts?.[0]?.text || \"Désolé, je ne comprends pas.\";\n};\n\nexport default function App() {\n  const [user, setUser] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [currentWordData, setCurrentWordData] = useState(null);\n  \n  // 缓存机制优化：存储已查询过的单词和专辑，避免重复请求\n  const [wordCache, setWordCache] = useState({}); \n  const [albumData, setAlbumData] = useState(null);\n  const [albumCache, setAlbumCache] = useState({}); \n\n  // 收藏相关\n  const [favorites, setFavorites] = useState([]);\n  const [favoriteAlbums, setFavoriteAlbums] = useState([]);\n\n  // 聊天相关\n  const [messages, setMessages] = useState([{ role: 'ai', text: 'Bonjour! Je suis ton prof de français. On discute? (你好！我是你的法语老师，我们聊聊？)' }]);\n  const [chatInput, setChatInput] = useState('');\n  const [isRecording, setIsRecording] = useState(false);\n  const chatEndRef = useRef(null);\n\n  const [activeTab, setActiveTab] = useState('search'); // 'search', 'favorites', 'album', 'chat'\n  \n  const getImageUrl = (keyword, size = 'medium') => {\n    const dimensions = size === 'small' ? 'width=200&height=200' : 'width=600&height=400';\n    // 增加随机数防止缓存导致图片不变\n    return `https://image.pollinations.ai/prompt/realistic%20${keyword}%20french%20context?${dimensions}&nologo=true&seed=${Math.random()}`;\n  };\n\n  useEffect(() => {\n    signInAnonymously(auth).catch(console.error);\n    const unsubscribe = onAuthStateChanged(auth, setUser);\n    return () => unsubscribe();\n  }, []);\n\n  // 同步单词收藏\n  useEffect(() => {\n    if (!user) return;\n    const q = query(collection(db, 'artifacts', appId, 'users', user.uid, 'favorites'));\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const favs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      favs.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));\n      setFavorites(favs);\n    });\n    return () => unsubscribe();\n  }, [user]);\n\n  // 同步专辑收藏\n  useEffect(() => {\n    if (!user) return;\n    const q = query(collection(db, 'artifacts', appId, 'users', user.uid, 'favoriteAlbums'));\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const favs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      setFavoriteAlbums(favs);\n    });\n    return () => unsubscribe();\n  }, [user]);\n\n  // 聊天滚动到底部\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages, activeTab]);\n\n  // --- Handlers ---\n  const handleSearch = async (e, wordOverride = null) => {\n    if (e) e.preventDefault();\n    const term = wordOverride || searchTerm;\n    const cleanTerm = term.trim().toLowerCase(); // 统一小写作为 key\n    if (!cleanTerm) return;\n    \n    setLoading(true);\n    setCurrentWordData(null);\n    setAlbumData(null);\n    setActiveTab('search');\n\n    // 1. 检查缓存\n    if (wordCache[cleanTerm]) {\n      setCurrentWordData(wordCache[cleanTerm]);\n      setLoading(false);\n      return;\n    }\n    \n    try {\n      const data = await fetchWordData(term);\n      setCurrentWordData(data);\n      // 2. 写入缓存\n      setWordCache(prev => ({ ...prev, [cleanTerm]: data, [data.word.toLowerCase()]: data })); \n    } catch (err) { alert(\"Error fetching word. Try again.\"); } \n    finally { setLoading(false); }\n  };\n\n  const handleSpeak = (text) => {\n    if ('speechSynthesis' in window) {\n      window.speechSynthesis.cancel();\n      const utterance = new SpeechSynthesisUtterance(text);\n      utterance.lang = 'fr-FR';\n      utterance.rate = 0.9;\n      window.speechSynthesis.speak(utterance);\n    }\n  };\n\n  const handleAlbumClick = async (category) => {\n    setActiveTab('album');\n    \n    // 检查缓存\n    if (albumCache[category]) {\n      setAlbumData(albumCache[category]);\n      return;\n    }\n\n    setLoading(true);\n    setAlbumData(null);\n    try {\n      const data = await fetchAlbumData(category);\n      setAlbumData(data);\n      // 写入缓存\n      setAlbumCache(prev => ({ ...prev, [category]: data }));\n    } catch (err) { console.error(err); alert(\"Failed to load album.\"); setActiveTab('search'); }\n    finally { setLoading(false); }\n  };\n\n  // --- Favorites Logic ---\n  const toggleFavoriteWord = async (wordData) => {\n    if (!user) return;\n    // 检查是否已收藏\n    const existing = favorites.find(f => f.word === wordData.word);\n    \n    try {\n      if (existing) {\n        await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'favorites', existing.id));\n      } else {\n        await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'favorites'), { ...wordData, timestamp: serverTimestamp() });\n      }\n    } catch (e) {\n      console.error(\"Fav Error\", e);\n      alert(\"操作失败，请检查网络\");\n    }\n  };\n\n  const toggleFavoriteAlbum = async (albumData) => {\n    if (!user || !albumData) return;\n    const existing = favoriteAlbums.find(f => f.category === albumData.category);\n    \n    try {\n      if (existing) {\n        await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'favoriteAlbums', existing.id));\n      } else {\n        await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'favoriteAlbums'), { ...albumData, timestamp: serverTimestamp() });\n      }\n    } catch (e) {\n      console.error(\"Album Fav Error\", e);\n    }\n  };\n\n  // --- Chat Logic ---\n  const handleSendChat = async () => {\n    if (!chatInput.trim()) return;\n    const userMsg = { role: 'user', text: chatInput };\n    setMessages(prev => [...prev, userMsg]);\n    setChatInput('');\n    \n    // 简单的加载状态模拟\n    setMessages(prev => [...prev, { role: 'ai', text: '...', isLoading: true }]);\n\n    try {\n      const responseText = await fetchChatResponse(messages.map(m => ({role: m.role, content: m.text})), userMsg.text);\n      setMessages(prev => {\n        const newMsgs = prev.filter(m => !m.isLoading);\n        return [...newMsgs, { role: 'ai', text: responseText }];\n      });\n      handleSpeak(responseText); // 自动朗读回复\n    } catch (e) {\n      setMessages(prev => prev.filter(m => !m.isLoading));\n    }\n  };\n\n  const startListening = () => {\n    if (!('webkitSpeechRecognition' in window)) {\n      alert(\"此浏览器不支持语音输入，请使用 Chrome。\");\n      return;\n    }\n    const recognition = new window.webkitSpeechRecognition();\n    recognition.lang = 'fr-FR'; // 默认听法语，也可以设为 'zh-CN'\n    recognition.continuous = false;\n    recognition.interimResults = false;\n\n    recognition.onstart = () => setIsRecording(true);\n    recognition.onend = () => setIsRecording(false);\n    recognition.onresult = (event) => {\n      const transcript = event.results[0][0].transcript;\n      setChatInput(transcript);\n    };\n    recognition.start();\n  };\n\n  // --- Components ---\n\n  const AlbumView = ({ data }) => {\n    if (!data) return null;\n    const isFav = favoriteAlbums.some(f => f.category === data.category);\n\n    return (\n      <div className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center gap-3\">\n            <button onClick={() => setActiveTab('search')} className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\">\n              <ArrowRight className=\"rotate-180 text-gray-500\" />\n            </button>\n            <h2 className=\"text-2xl font-bold text-gray-900 flex items-center gap-2\">\n              <Layers className=\"text-blue-600\" size={24} />\n              {data.category}\n            </h2>\n          </div>\n          <button \n            onClick={() => toggleFavoriteAlbum(data)}\n            className={`p-3 rounded-full transition-colors ${isFav ? 'bg-red-50 text-red-500' : 'bg-gray-50 text-gray-400 hover:text-red-400'}`}\n          >\n            <Heart size={24} fill={isFav ? \"currentColor\" : \"none\"} />\n          </button>\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-4\">\n          {data.items.map((item, idx) => {\n            if (item.isVisual) {\n              return (\n                <button \n                  key={idx}\n                  onClick={() => handleSearch(null, item.word)}\n                  className=\"group relative flex flex-col items-center bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-lg transition-all border border-gray-100 text-left\"\n                >\n                  <div className=\"w-full aspect-[4/3] bg-gray-50 relative overflow-hidden\">\n                    <img \n                      src={getImageUrl(item.word, 'small')} \n                      alt={item.word} \n                      className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700\"\n                    />\n                    <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-3 pt-8\">\n                       <p className=\"text-white font-medium text-lg\">\n                         <span className=\"opacity-70 text-sm mr-1 font-normal\">{item.article}</span>\n                         {item.word}\n                       </p>\n                    </div>\n                  </div>\n                </button>\n              );\n            } else {\n              return (\n                <button \n                  key={idx}\n                  onClick={() => handleSearch(null, item.word)}\n                  className=\"col-span-2 flex items-center justify-between p-4 bg-white rounded-xl shadow-sm hover:shadow-md border border-gray-100 hover:border-blue-200 transition-all group\"\n                >\n                  <div>\n                    <span className=\"text-lg font-bold text-gray-800 group-hover:text-blue-600 transition-colors\">{item.word}</span>\n                  </div>\n                  <span className=\"text-sm text-gray-500 font-medium\">{item.zh}</span>\n                </button>\n              );\n            }\n          })}\n        </div>\n      </div>\n    );\n  };\n\n  const WordCard = ({ data, onDelete }) => {\n    const [showPhraseDetails, setShowPhraseDetails] = useState(false);\n    const [showAllPhrases, setShowAllPhrases] = useState(false);\n    const isFav = favorites.some(f => f.word === data.word);\n\n    return (\n    <div className=\"bg-white rounded-[2rem] shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 mb-8\">\n      <div className=\"h-56 overflow-hidden bg-gray-50 relative\">\n        <img src={getImageUrl(data.word)} alt={data.word} className=\"w-full h-full object-cover\" />\n      </div>\n\n      <div className=\"flex gap-2 px-8 pt-4 bg-white\">\n        <span className=\"bg-blue-50 px-3 py-1.5 rounded-full text-xs font-bold text-blue-600 uppercase tracking-wider\">\n          {data.partOfSpeech}\n        </span>\n        <button \n          onClick={() => handleAlbumClick(data.collection)}\n          className=\"bg-gray-100 hover:bg-gray-200 px-3 py-1.5 rounded-full text-xs font-bold text-gray-600 flex items-center gap-1.5 transition-colors cursor-pointer\"\n        >\n          <Layers size={14} />\n          {data.collection}\n        </button>\n      </div>\n\n      <div className=\"p-8 pt-2\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <div className=\"flex items-center gap-3\">\n            <h2 className=\"text-4xl font-bold text-gray-900 tracking-tight\">{data.word}</h2>\n            <button onClick={(e) => { e.stopPropagation(); handleSpeak(data.word); }} className=\"p-2.5 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors\">\n              <Volume2 size={20} />\n            </button>\n          </div>\n          {onDelete ? (\n             <button onClick={() => onDelete(data.id)} className=\"p-2.5 rounded-full text-gray-300 hover:text-red-500 hover:bg-red-50 transition-colors\">\n               <X size={22} />\n             </button>\n          ) : (\n             <button onClick={() => toggleFavoriteWord(data)} className={`p-2.5 rounded-full transition-colors ${isFav ? 'text-yellow-400 bg-yellow-50' : 'text-gray-300 hover:text-yellow-400 hover:bg-yellow-50'}`}>\n               <Star size={22} fill={isFav ? \"currentColor\" : \"none\"} />\n             </button>\n          )}\n        </div>\n\n        {/* 释义：上下布局 */}\n        <div className=\"mb-8 space-y-3 bg-gray-50/50 p-4 rounded-xl\">\n           <div className=\"flex flex-col gap-1\">\n             <span className=\"text-xs font-bold text-gray-400 uppercase\">CN</span>\n             <span className=\"text-xl font-bold text-gray-900 leading-snug\">{data.definitions.zh}</span>\n           </div>\n           <div className=\"h-px bg-gray-200 w-full my-1\"></div>\n           <div className=\"flex flex-col gap-1\">\n             <span className=\"text-xs font-bold text-gray-400 uppercase\">EN</span>\n             <span className=\"text-lg font-medium text-gray-600 leading-snug\">{data.definitions.en}</span>\n           </div>\n        </div>\n\n        {/* 交互式例句 */}\n        <div className=\"space-y-4\">\n          <div onClick={() => { handleSpeak(data.examplePhrase.fr); setShowPhraseDetails(!showPhraseDetails); }} className=\"bg-blue-50/50 rounded-xl border border-blue-100 overflow-hidden cursor-pointer hover:bg-blue-50 transition-colors\">\n            <div className=\"p-4 flex justify-between items-start gap-3\">\n               <div>\n                 <div className=\"flex items-center gap-2 mb-1\">\n                    <span className=\"text-[10px] font-bold text-blue-400 uppercase tracking-widest\">Exemple</span>\n                    <Mic size={12} className=\"text-blue-400\" />\n                 </div>\n                 <p className=\"text-xl text-gray-800 font-serif italic leading-snug\">\"{data.examplePhrase.fr}\"</p>\n               </div>\n               <ChevronDown size={18} className={`text-blue-300 mt-2 transition-transform ${showPhraseDetails ? 'rotate-180' : ''}`} />\n            </div>\n            {showPhraseDetails && (\n              <div className=\"px-4 pb-4 pt-0 space-y-2 animate-in slide-in-from-top-2\">\n                 <p className=\"text-sm text-gray-600\">{data.examplePhrase.zh}</p>\n                 <p className=\"text-sm text-gray-500\">{data.examplePhrase.en}</p>\n                 {data.examplePhrase.explanation && (\n                   <div className=\"mt-2 text-xs text-blue-500 bg-blue-100/50 p-2 rounded-lg\">💡 {data.examplePhrase.explanation}</div>\n                 )}\n              </div>\n            )}\n          </div>\n\n          {/* 相关短语 */}\n          {data.relatedPhrases && data.relatedPhrases.length > 0 && (\n            <div className=\"pl-2\">\n              <h4 className=\"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider\">常用短语</h4>\n              <div className=\"space-y-2\">\n                {data.relatedPhrases.slice(0, showAllPhrases ? undefined : 2).map((phrase, idx) => (\n                   <div key={idx} className=\"flex justify-between items-center group py-1 border-b border-gray-50 last:border-0\">\n                      <span className=\"text-gray-700 font-medium cursor-pointer hover:text-blue-600\" onClick={() => handleSpeak(phrase.fr)}>{phrase.fr}</span>\n                      <span className=\"text-sm text-gray-400\">{phrase.zh}</span>\n                   </div>\n                ))}\n              </div>\n              {data.relatedPhrases.length > 2 && (\n                <button onClick={() => setShowAllPhrases(!showAllPhrases)} className=\"text-xs text-blue-500 font-medium mt-2 hover:underline flex items-center gap-1\">\n                  {showAllPhrases ? \"收起\" : `查看更多 (${data.relatedPhrases.length - 2})`}\n                </button>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* 底部相关词 */}\n        {data.relatedWords && data.relatedWords.length > 0 && (\n          <div className=\"pt-8 mt-8 border-t border-gray-100\">\n             <div className=\"flex overflow-x-auto pb-4 gap-3 no-scrollbar\">\n                {data.relatedWords.map((word, idx) => (\n                  <button key={idx} onClick={() => handleSearch(null, word)} className=\"flex-shrink-0 flex flex-col items-center w-20 group\">\n                    <div className=\"w-16 h-16 rounded-xl overflow-hidden mb-2 bg-gray-100 border border-gray-200 group-hover:border-blue-300 transition-all\">\n                       <img src={getImageUrl(word, 'small')} className=\"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-110 transition-all\" />\n                    </div>\n                    <span className=\"text-xs text-gray-500 group-hover:text-blue-600 truncate w-full text-center\">{word}</span>\n                  </button>\n                ))}\n             </div>\n          </div>\n        )}\n      </div>\n    </div>\n    );\n  };\n\n  const ChatView = () => (\n    <div className=\"flex flex-col h-[calc(100vh-140px)]\">\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {messages.map((msg, idx) => (\n          <div key={idx} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n            <div className={`max-w-[80%] p-4 rounded-2xl ${\n              msg.role === 'user' \n                ? 'bg-blue-600 text-white rounded-br-none' \n                : 'bg-white border border-gray-100 text-gray-800 rounded-bl-none shadow-sm'\n            }`}>\n              <p className=\"text-sm leading-relaxed\">{msg.text}</p>\n              {msg.role === 'ai' && !msg.isLoading && (\n                 <button onClick={() => handleSpeak(msg.text)} className=\"mt-2 text-blue-400 hover:text-blue-600\"><Volume2 size={16} /></button>\n              )}\n            </div>\n          </div>\n        ))}\n        <div ref={chatEndRef} />\n      </div>\n      <div className=\"p-4 bg-white border-t border-gray-100\">\n        <div className=\"flex items-center gap-2 bg-gray-50 p-2 rounded-full border border-gray-200 focus-within:ring-2 focus-within:ring-blue-100 transition-all\">\n          <input \n            type=\"text\" \n            value={chatInput} \n            onChange={e => setChatInput(e.target.value)} \n            placeholder=\"Type or speak (French)...\" \n            className=\"flex-1 bg-transparent border-none focus:ring-0 px-4 py-2 text-gray-800 placeholder-gray-400\"\n            onKeyDown={e => e.key === 'Enter' && handleSendChat()}\n          />\n          <button \n            onClick={startListening} \n            className={`p-2 rounded-full transition-colors ${isRecording ? 'bg-red-500 text-white animate-pulse' : 'text-gray-400 hover:text-blue-600'}`}\n          >\n            <Mic size={20} />\n          </button>\n          <button \n            onClick={handleSendChat} \n            className=\"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors shadow-md disabled:opacity-50\"\n            disabled={!chatInput.trim()}\n          >\n            <Send size={18} />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 font-sans text-gray-900 pb-24\">\n      {/* Header */}\n      <div className=\"bg-white/80 backdrop-blur-md border-b border-gray-100 sticky top-0 z-30\">\n        <div className=\"max-w-xl mx-auto px-6 py-4 flex justify-between items-center\">\n          <h1 \n            onClick={() => setActiveTab('search')}\n            className=\"text-xl font-bold text-gray-900 flex items-center gap-2 tracking-tight cursor-pointer\"\n          >\n            <BookOpen size={22} className=\"text-blue-600\" />\n            FrenchMemo\n          </h1>\n          <div className=\"text-xs text-gray-400 font-medium font-mono\">\n             {user ? `UID: ${user.uid.slice(0,4)}` : 'Connecting...'}\n          </div>\n        </div>\n        \n        {/* Navigation Tabs (Fixed Bottom on Mobile usually, but here top for simplicity as per previous design) */}\n        {activeTab !== 'album' && (\n          <div className=\"flex max-w-xl mx-auto px-6 overflow-x-auto no-scrollbar\">\n            <button onClick={() => setActiveTab('search')} className={`flex-1 pb-3 text-sm font-semibold border-b-2 transition-all whitespace-nowrap px-4 ${activeTab === 'search' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-400 hover:text-gray-600'}`}>Search</button>\n            <button onClick={() => setActiveTab('chat')} className={`flex-1 pb-3 text-sm font-semibold border-b-2 transition-all whitespace-nowrap px-4 ${activeTab === 'chat' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-400 hover:text-gray-600'}`}>Chat AI</button>\n            <button onClick={() => setActiveTab('favorites')} className={`flex-1 pb-3 text-sm font-semibold border-b-2 transition-all whitespace-nowrap px-4 ${activeTab === 'favorites' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-400 hover:text-gray-600'}`}>Favs ({favorites.length})</button>\n          </div>\n        )}\n      </div>\n\n      <div className=\"max-w-xl mx-auto px-6 py-8\">\n        \n        {/* Chat Tab */}\n        {activeTab === 'chat' && <ChatView />}\n\n        {/* Album Tab */}\n        {activeTab === 'album' && loading && (\n           <div className=\"text-center py-20 flex flex-col items-center\">\n             <Loader2 className=\"animate-spin text-blue-600 mb-4\" size={32} />\n             <p className=\"text-gray-500\">正在生成专辑...</p>\n           </div>\n        )}\n        \n        {activeTab === 'album' && !loading && albumData && <AlbumView data={albumData} />}\n\n        {/* Search Tab */}\n        {activeTab === 'search' && (\n          <>\n            <form onSubmit={handleSearch} className=\"relative mb-10 group z-10\">\n              <div className={`absolute inset-0 bg-blue-500/5 rounded-full blur-xl transition-opacity duration-300 ${loading ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'}`}></div>\n              <input type=\"text\" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} placeholder=\"输入中/英/法文...\" className=\"w-full pl-14 pr-14 py-4 bg-white border-0 rounded-full shadow-[0_8px_30px_rgb(0,0,0,0.06)] text-xl font-medium placeholder:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500/20 transition-all relative z-10\" />\n              <Search className=\"absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 z-20\" size={22} />\n              <button type=\"submit\" disabled={loading} className=\"absolute right-3 top-1/2 -translate-y-1/2 p-2.5 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors disabled:opacity-70 hover:scale-105 active:scale-95 z-20 shadow-md\">\n                {loading ? <Loader2 className=\"animate-spin\" size={20} /> : <ArrowRight size={20} />}\n              </button>\n            </form>\n            {currentWordData && <WordCard data={currentWordData} />}\n            {!currentWordData && !loading && (\n              <div className=\"text-center py-16\">\n                <div className=\"bg-white p-6 rounded-full inline-block shadow-sm mb-6\"><Search size={40} className=\"text-blue-100\" /></div>\n                <h3 className=\"text-gray-900 font-bold text-lg mb-2\">Prêt à apprendre ?</h3>\n                <p className=\"text-gray-500 mb-8\">支持中文、英语或法语输入，自动翻译并解析。</p>\n              </div>\n            )}\n          </>\n        )}\n\n        {/* Favorites Tab */}\n        {activeTab === 'favorites' && (\n          <div className=\"space-y-8\">\n            {favoriteAlbums.length > 0 && (\n              <div className=\"mb-8\">\n                <h3 className=\"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4\">收藏的专辑</h3>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {favoriteAlbums.map(album => (\n                    <button key={album.id} onClick={() => handleAlbumClick(album.category)} className=\"bg-white p-4 rounded-xl border border-gray-100 shadow-sm text-left hover:border-blue-200 transition-all\">\n                      <div className=\"flex justify-between items-start\">\n                         <span className=\"font-bold text-gray-800\">{album.category}</span>\n                         <Layers size={16} className=\"text-blue-500\" />\n                      </div>\n                      <span className=\"text-xs text-gray-400 mt-2 block\">{album.items.length} words</span>\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            <h3 className=\"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4\">收藏的单词</h3>\n            {favorites.length === 0 ? (\n              <div className=\"text-center py-10\"><p className=\"text-gray-500 font-medium\">暂无收藏单词</p></div>\n            ) : (\n              favorites.map(fav => <WordCard key={fav.id} data={fav} onDelete={toggleFavoriteWord} />)\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}